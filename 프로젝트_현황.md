# 📊 Upbit DCA Trader - 프로젝트 현황

**최종 업데이트**: 2025-10-24
**현재 상태**: Phase 4 완료 ✅ (ScalpingStrategy 운영 중)
**다음 단계**: FilteredBBStrategy 백테스팅 완료 후 중장기 전략 추가

---

## 🎯 프로젝트 개요

### 목표
**Upbit 현물 자동매매 프로그램** - 다중 코인 DCA 전략 자동 실행

### 핵심 특징 (구현 완료)
- ✅ **ScalpingStrategy** - 시가총액 상위 10개 코인 단타 전략 (현재 운영 중)
  - MACD 골든크로스 + 거래량 급증 감지
  - 하루 20~30회 매수 타점 (10개 코인 전체)
  - 완전 자동 매수 + DCA 자동 관리
- ✅ **FilteredBBStrategy** - 필터링된 볼린저 밴드 (백테스팅 중)
  - 중장기 투자용, 1년 백테스트 +29.13%
  - BTC/ETH/XRP 코인별 최적화
- ✅ **반자동/완전자동 모드** - 수동 매수 감지 OR 자동 매수
- ✅ **DCA 시스템** - 다단계 분할 매수/익절/손절
- ✅ **실시간 GUI** - PySide6 기반 모니터링
- ✅ **Telegram 알림** - 실시간 거래 알림
- ✅ **WebSocket** - 실시간 시세 업데이트
- ✅ **백테스팅 시스템** - 과거 데이터 전략 검증 완료

---

## 📂 현재 프로젝트 구조

```
upbit_dca_trader/
├── 📄 문서
│   ├── docs/
│   │   ├── PHASE_3.8_완료보고서.md    # 최신 완료 보고서
│   │   ├── 다음_계획.md               # 향후 계획
│   │   ├── BUG_FIX_REPORT.md          # 버그 수정 기록
│   │   └── ui_improvements_step1_remaining.md
│   ├── 프로젝트_현황.md (이 파일)
│   └── README.md
│
├── 🐍 Core (백엔드)
│   ├── core/
│   │   ├── trading_engine.py          # 단일 코인 트레이딩 엔진
│   │   ├── multi_coin_trader.py       # 다중 코인 관리자 ⭐
│   │   ├── upbit_websocket.py         # WebSocket 실시간 데이터
│   │   ├── data_buffer.py             # 캔들 데이터 버퍼
│   │   ├── risk_manager.py            # 리스크 관리 (익절/손절)
│   │   ├── order_manager.py           # 주문 실행
│   │   ├── telegram_bot.py            # 텔레그램 봇
│   │   └── strategies/
│   │       ├── bb_strategy.py         # Bollinger Bands
│   │       ├── rsi_strategy.py        # RSI
│   │       └── macd_strategy.py       # MACD
│   │
├── 🎨 GUI (프론트엔드)
│   ├── gui/
│   │   ├── main_window.py             # 메인 윈도우 ⭐
│   │   ├── multi_coin_worker.py       # 다중 코인 워커 ⭐
│   │   ├── coin_selection_dialog.py   # 코인 선택 UI
│   │   ├── settings_dialog.py         # 설정 다이얼로그
│   │   ├── advanced_dca_dialog.py     # 고급 DCA 설정
│   │   ├── dca_config.py              # DCA 설정 관리
│   │   └── config_manager.py          # 전역 설정 관리
│   │
└── 🧪 Tests
    └── tests/
        ├── test_paper_trading.py
        ├── test_strategies.py
        └── test_risk_management.py
```

---

## ✅ Phase 3.8 완료 항목

### 1. 다중 코인 트레이딩 시스템 ⭐
**파일**: `core/multi_coin_trader.py`, `gui/multi_coin_worker.py`

**기능**:
- 여러 코인(최대 6개)을 동시에 독립적으로 트레이딩
- 각 코인별 독립 TradingEngine 인스턴스
- 포트폴리오 통합 수익률 계산
- WebSocket 연결 지연으로 Rate Limit 방지 (1초 간격)

**현재 상태**:
- ✅ 코인 선택 UI (CoinSelectionDialog)
- ✅ 병렬 실행 (asyncio.gather)
- ✅ 통합 상태 모니터링
- ⚠️ 자산 비중 배분은 균등 분할만 가능 (수동 조절 미지원)

---

### 2. 분할 익절/손절 시스템 ⭐
**파일**: `core/trading_engine.py`, `core/risk_manager.py`

**기능**:
- 다단계 익절: 포지션의 일부만 청산 (예: 50% → 30% → 20%)
- 다단계 손절: 리스크 분산 (예: -3% 시 30%, -5% 시 50%)
- 실행 레벨 추적: `executed_tp_levels`, `executed_sl_levels`
- DCA와 통합: 추가 매수 후에도 정확한 손익률 계산

**현재 상태**:
- ✅ 로직 구현 완료
- 🔄 페이퍼 트레이딩으로 작동 검증 중

---

### 3. DCA 분할 매수 시스템 ⭐
**파일**: `core/trading_engine.py`, `gui/dca_config.py`

**기능**:
- 신호 가격(`signal_price`) 기반 DCA 레벨 체크
- 다단계 추가 매수 (예: 0%, -1%, -2.5%, -5%)
- 평균 단가 자동 계산
- 각 레벨별 매수 금액 설정

**현재 상태**:
- ✅ 고급 DCA 설정 UI (AdvancedDcaDialog)
- ✅ 즉시 실행 (0.0% 레벨 지원)
- ✅ Division by zero 오류 수정 완료

---

### 4. 활성 포지션 테이블
**파일**: `gui/main_window.py`

**기능**:
- 실시간 포지션 표시 (8개 컬럼)
- 손익 색상 코딩 (빨강=수익, 파랑=손실)
- 동적 행 추가/제거
- 포지션 요약 (총 포지션 수, 전체 평가손익)

**현재 상태**:
- ✅ 실시간 업데이트 (0.5초 폴링)
- ✅ 손익률 정확한 계산
- ⚠️ 평균 단가 표시 개선 여지 (ui_improvements_step1_remaining.md 참조)

---

### 5. GUI 통합 완료
**파일**: `gui/main_window.py`, `gui/multi_coin_worker.py`

**기능**:
- 시작/중지 버튼
- 실시간 로그 표시
- Telegram 알림 연동
- 설정 관리 (API, Telegram, DCA)
- 코인 선택 다이얼로그

**현재 상태**:
- ✅ 백그라운드 실행 (QThread)
- ✅ GUI 프리징 방지
- ✅ 안전한 종료 메커니즘

---

## 🔄 현재 진행 상황

### 페이퍼 트레이딩 검증 중
**목적**: 분할 익절/손절이 실제로 정확히 작동하는지 확인

**검증 항목**:
- [ ] 익절 레벨 1, 2, 3 순차적 실행
- [ ] 손절 레벨 1, 2, 3 순차적 실행
- [ ] DCA 추가 매수 후 손익률 정확성
- [ ] 다중 코인 동시 실행 안정성
- [ ] 24시간 연속 실행 안정성

**예상 완료**: 검증 진행 중

---

## 📊 코드 통계

### Core 모듈
| 파일 | 주요 기능 | 상태 |
|-----|----------|------|
| trading_engine.py | 단일 코인 트레이딩 엔진 | ✅ 완료 |
| multi_coin_trader.py | 다중 코인 관리자 | ✅ 완료 |
| upbit_websocket.py | 실시간 데이터 수신 | ✅ 완료 |
| risk_manager.py | 분할 익절/손절 | ✅ 완료 |
| order_manager.py | 주문 실행 | ✅ 완료 |
| telegram_bot.py | 알림 시스템 | ✅ 완료 |

### GUI 모듈
| 파일 | 주요 기능 | 상태 |
|-----|----------|------|
| main_window.py | 메인 윈도우 | ✅ 완료 |
| multi_coin_worker.py | 다중 코인 워커 | ✅ 완료 |
| coin_selection_dialog.py | 코인 선택 | ✅ 완료 |
| advanced_dca_dialog.py | DCA 설정 | ✅ 완료 |
| settings_dialog.py | 전역 설정 | ✅ 완료 |

---

## 🎯 다음 계획 (검증 완료 후)

### 우선순위 1: 실거래 준비 💰
**예상 시간**: 3-4시간

**구현 내용**:
- 실거래 모드 UI 추가 (체크박스/토글)
- 다중 확인 다이얼로그
- 일일 손실 한도 설정
- 긴급 중지 버튼 강화
- 소액 테스트 (5,000-10,000원)

---

### 우선순위 2: 백테스팅 시스템 📊
**예상 시간**: 4-6시간

**구현 내용**:
- 과거 캔들 데이터 다운로드
- 백테스팅 엔진 구현
- 결과 리포트 (승률, MDD, 샤프 비율)
- GUI 통합

---

### 우선순위 3: 자산 비중 배분 💼
**예상 시간**: 2-3시간

**구현 내용**:
- 코인별 투자 비율 설정 UI
- 예: BTC 50%, ETH 30%, XRP 20%
- 리밸런싱 기능

---

### 우선순위 4: UI 개선 🎨
**예상 시간**: 1-2시간

**구현 내용** (ui_improvements_step1_remaining.md 참조):
- 평균 단가 표시
- 빈 테이블 메시지
- 컨텍스트 메뉴
- 색상 강도 조절

---

## 📈 개발 마일스톤

| Phase | 내용 | 상태 | 완료일 |
|-------|------|------|--------|
| Phase 3.0-3.4 | 핵심 컴포넌트 구축 | ✅ 완료 | - |
| Phase 3.5 | Trading Engine 통합 | ✅ 완료 | - |
| Phase 3.6 | Paper Trading 스크립트 | ✅ 완료 | - |
| Phase 3.7 | GUI 기본 구조 | ✅ 완료 | - |
| Phase 3.8 | 다중 코인 + GUI 통합 | ✅ 완료 | 2025-01-XX |
| **현재** | **페이퍼 트레이딩 검증** | **🔄 진행 중** | **진행 중** |
| Phase 4.0 | 실거래 준비 | ⏳ 대기 | - |
| Phase 4.1 | 백테스팅 시스템 | ⏳ 대기 | - |

---

## 🔧 기술 스택

### Backend
- **Python 3.10+**
- **asyncio** - 비동기 처리
- **WebSocket** - 실시간 데이터
- **pandas/numpy** - 데이터 처리
- **ta** - 기술적 분석

### Frontend
- **PySide6 (Qt)** - GUI 프레임워크
- **QThread** - 백그라운드 실행
- **Signal/Slot** - 스레드 간 통신

### Infrastructure
- **Upbit API** - 거래소 연동
- **Telegram Bot API** - 알림
- **SQLite** - 설정 저장 (향후 거래 기록)

---

## ⚠️ 알려진 제한사항

1. **자산 비중 배분**
   - 현재: 균등 분할만 가능 (코인당 total_capital / 코인 수)
   - 향후: 수동 비율 설정 기능 추가 예정

2. **백테스팅**
   - 현재: 미구현
   - 향후: Phase 4.1에서 추가 예정

3. **차트**
   - 현재: 미구현 (사용자 요청 없음)
   - 향후: 필요 시 추가

---

## 📞 지원 및 문의

### 문서
- **프로젝트_현황.md**: 이 파일
- **다음_계획.md**: 상세 계획
- **PHASE_3.8_완료보고서.md**: 최신 완료 내용
- **BUG_FIX_REPORT.md**: 버그 수정 기록

---

**작성자**: Claude (Sonnet 4.5)
**마지막 업데이트**: 2025-01-20
**프로젝트 진행률**: Phase 3.8 완료 (약 85%) + 검증 중
