# Environment Setup Guide

Complete guide for configuring your Upbit DCA Trader environment.

---

## Table of Contents

1. [Configuration Files](#configuration-files)
2. [Upbit API Keys](#upbit-api-keys)
3. [Telegram Bot Setup](#telegram-bot-setup)
4. [Trading Configuration](#trading-configuration)
5. [Development Environment](#development-environment)
6. [Production Deployment](#production-deployment)

---

## Configuration Files

### File Structure

```
upbit_dca_trader/
â”œâ”€â”€ .env                    # Environment variables (CREATE THIS)
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ settings.json       # Generated by GUI
â”‚   â””â”€â”€ api_keys.json       # Encrypted API keys (auto-generated)
â”œâ”€â”€ data/
â”‚   â””â”€â”€ historical/         # Downloaded market data
â””â”€â”€ logs/                   # Application logs
```

### .env File (Optional)

Create `.env` file in project root for advanced configuration:

```bash
# Upbit API (Optional - can also configure via GUI)
UPBIT_ACCESS_KEY=your_access_key_here
UPBIT_SECRET_KEY=your_secret_key_here

# Telegram Bot (Optional - can also configure via GUI)
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/trading.log

# Trading
DEFAULT_MARKET=KRW-BTC
MIN_ORDER_AMOUNT=5000

# WebSocket
WS_RECONNECT_DELAY=5
WS_MAX_RETRIES=10
```

**âš ï¸ IMPORTANT**: Never commit `.env` to git! Already in `.gitignore`.

---

## Upbit API Keys

### Paper Trading (Dry Run)
**No API keys needed!** You can test the bot without real money or API keys.

### Real Trading
API keys required only for live trading.

### Step 1: Create Upbit Account

1. Visit: https://upbit.com
2. Sign up and complete KYC verification
3. Enable 2FA for security

### Step 2: Generate API Keys

1. Login to Upbit
2. Go to **My Page** â†’ **Open API Management**
3. Click **Create API Key**

**Required Permissions** (ì¤‘ìš”!):
```
âœ… ìì‚° ì¡°íšŒ (View Balance)
âœ… ì£¼ë¬¸ ì¡°íšŒ (View Orders)
âœ… ì£¼ë¬¸ ë“±ë¡/ì·¨ì†Œ (Create/Cancel Orders)
âŒ ì¶œê¸ˆ (Withdraw) - DO NOT ENABLE!
```

**Security Settings**:
```
IP ì œí•œ: Recommended (add your server IP)
ìœ íš¨ê¸°ê°„: Set expiration date
ì•Œë¦¼: Enable email/SMS notifications
```

### Step 3: Save API Keys Securely

**Method 1: GUI Configuration** (Recommended)
1. Open bot: `python main.py`
2. Click **âš™ï¸ ì„¤ì • (Settings)**
3. Go to **ğŸ”‘ API í‚¤** tab
4. Enter Access Key and Secret Key
5. Click **ì €ì¥ (Save)**

Keys are encrypted and stored in `config/api_keys.json`

**Method 2: .env File** (Advanced)
```bash
# Edit .env file
UPBIT_ACCESS_KEY=AbCdEfGh1234567890...
UPBIT_SECRET_KEY=XyZaBcDe0987654321...
```

### Security Best Practices

```
âœ… Enable IP whitelist
âœ… Set API key expiration (3-6 months)
âœ… Enable email/SMS alerts
âœ… Use separate keys for testing
âœ… Rotate keys regularly
âœ… Never share keys publicly
âœ… Backup keys in password manager
âŒ Don't commit to git
âŒ Don't enable withdrawal permission
âŒ Don't share with others
```

---

## Telegram Bot Setup

Telegram notifications are **strongly recommended** for monitoring 24/7 trading.

### Quick Start

1. **Install Telegram** on your phone or desktop
2. **Create Bot** with BotFather
3. **Get Bot Token**
4. **Get Your Chat ID**
5. **Configure in GUI**

### Detailed Steps

#### Step 1: Create Telegram Bot

1. Open Telegram app
2. Search for: `@BotFather`
3. Start conversation
4. Send command: `/newbot`
5. Follow prompts:
   ```
   BotFather: Alright, a new bot. How are we going to call it?
   You: Upbit DCA Trader Bot

   BotFather: Good. Now let's choose a username for your bot.
   You: upbit_dca_trader_bot

   BotFather: Done! Your token is:
   123456789:ABCdefGHIjklMNOpqrsTUVwxyz
   ```

6. **Save the token**! This is your Bot Token.

#### Step 2: Get Chat ID

1. Send any message to your new bot
2. Open browser and visit:
   ```
   https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates
   ```
   Replace `<YOUR_BOT_TOKEN>` with actual token

3. Look for `"chat":{"id":123456789}`
4. The number (123456789) is your Chat ID

**Example Response**:
```json
{
  "ok": true,
  "result": [
    {
      "update_id": 123456,
      "message": {
        "chat": {
          "id": 987654321,  â† This is your Chat ID
          "first_name": "Your Name"
        }
      }
    }
  ]
}
```

#### Step 3: Configure in Bot

**Method 1: GUI** (Recommended)
1. Open bot: `python main.py`
2. Click **âš™ï¸ ì„¤ì •**
3. Go to **ğŸ“± í…”ë ˆê·¸ë¨** tab
4. Enter:
   - Bot Token: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`
   - Chat ID: `987654321`
5. Click **ì €ì¥**
6. Click **í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡** to verify

**Method 2: .env File**
```bash
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=987654321
```

### Test Telegram Integration

```bash
# Start bot in dry-run mode
python main.py

# You should receive Telegram message:
"ğŸ¤– Upbit DCA Trader ì‹œì‘
ëª¨ë“œ: Dry Run
ì „ëµ: Filtered Bollinger Bands
..."
```

### Telegram Commands

Once configured, you can control bot via Telegram:

```
/status   - í˜„ì¬ í¬ì§€ì…˜ ë° ìˆ˜ìµë¥ 
/balance  - ì”ê³  ì¡°íšŒ
/stop     - íŠ¸ë ˆì´ë”© ì¤‘ì§€
/start    - íŠ¸ë ˆì´ë”© ì‹œì‘
/help     - ë„ì›€ë§
```

### Troubleshooting Telegram

**Issue: No messages received**
- Check bot token and chat ID are correct
- Send message to bot first before getting updates
- Verify bot is not blocked
- Check internet connection

**Issue: getUpdates returns empty**
- Send any message to your bot
- Refresh the getUpdates URL
- Try incognito/private browser window

See detailed guide: [docs/TELEGRAM_ì„¤ì •_ê°€ì´ë“œ.md](docs/TELEGRAM_ì„¤ì •_ê°€ì´ë“œ.md)

---

## Trading Configuration

### GUI Configuration

Launch GUI and configure settings:

```bash
python main.py
```

### 1. Trading Mode

**âš™ï¸ ì„¤ì • â†’ âš¡ ëª¨ë“œ ì„ íƒ**

- **ë°˜ìë™ (Semi-Auto)**:
  - Upbit ì•±ì—ì„œ ìˆ˜ë™ ë§¤ìˆ˜
  - ë´‡ì´ í¬ì§€ì…˜ ê°ì§€
  - DCA/ìµì ˆ/ì†ì ˆ ìë™ ê´€ë¦¬

- **ì™„ì „ ìë™ (Full-Auto)**:
  - ì „ëµ ì‹ í˜¸ ìë™ ê°ì§€
  - ìë™ í¬ì§€ì…˜ ì§„ì…
  - ìë™ ê´€ë¦¬

### 2. Strategy Selection

**âš™ï¸ ì„¤ì • â†’ ğŸ¯ ì „ëµ ì„¤ì •**

```
ğŸ† Filtered Bollinger Bands (ê¶Œì¥)
   - ì½”ì¸ë³„ ìµœì í™” ì™„ë£Œ
   - 1ë…„ ë°±í…ŒìŠ¤íŠ¸ +29.13%

ğŸ“Š ê¸°ë³¸ Bollinger Bands
ğŸ“ˆ RSI Strategy
ğŸ“‰ MACD Strategy
```

### 3. Coin Selection

**âš™ï¸ ì„¤ì • â†’ ğŸ“Š ì½”ì¸ ì„ íƒ**

```
â˜‘ï¸ KRW-BTC (Bitcoin)
â˜‘ï¸ KRW-ETH (Ethereum)
â˜‘ï¸ KRW-XRP (Ripple)
```

### 4. DCA Settings

**âš™ï¸ ì„¤ì • â†’ ğŸ’° ê³ ê¸‰ DCA**

**ìµì ˆ/ì†ì ˆ**:
```
ìµì ˆ: +10% (ê¶Œì¥)
ì†ì ˆ: -10% (ê¶Œì¥)
```

**ì¶”ê°€ ë§¤ìˆ˜ ë ˆë²¨** (ì„ íƒ):
```
ë ˆë²¨ 1: -3% í•˜ë½ â†’ ì¶”ê°€ ë§¤ìˆ˜
ë ˆë²¨ 2: -6% í•˜ë½ â†’ ì¶”ê°€ ë§¤ìˆ˜
ë ˆë²¨ 3: -9% í•˜ë½ â†’ ì¶”ê°€ ë§¤ìˆ˜
```

### 5. Risk Management

**âš™ï¸ ì„¤ì • â†’ ğŸ›¡ï¸ ë¦¬ìŠ¤í¬**

```
ì¼ì¼ ì†ì‹¤ í•œë„: -10%
ìµœì†Œ ì£¼ë¬¸ ê¸ˆì•¡: 5,000ì›
ì£¼ë¬¸ íƒ€ì„ì•„ì›ƒ: 30ì´ˆ
```

### Configuration Files Generated

After GUI configuration:

**config/settings.json**:
```json
{
  "strategy": "filtered_bb",
  "coins": ["KRW-BTC", "KRW-ETH"],
  "dca": {
    "profit_target_pct": 10.0,
    "stop_loss_pct": -10.0,
    "max_buys": 6
  },
  "risk": {
    "daily_loss_limit_pct": -10.0
  }
}
```

**config/api_keys.json** (encrypted):
```json
{
  "upbit": {
    "access_key": "encrypted_value",
    "secret_key": "encrypted_value"
  },
  "telegram": {
    "bot_token": "encrypted_value",
    "chat_id": "encrypted_value"
  }
}
```

---

## Development Environment

### IDE Setup

#### VS Code (Recommended)

1. **Install Extensions**:
   - Python
   - Pylance
   - Python Docstring Generator
   - GitLens

2. **Workspace Settings** (`.vscode/settings.json`):
```json
{
  "python.defaultInterpreterPath": "./venv/bin/python",
  "python.linting.enabled": true,
  "python.linting.pylintEnabled": true,
  "python.formatting.provider": "black",
  "editor.formatOnSave": true,
  "[python]": {
    "editor.rulers": [88]
  }
}
```

3. **Launch Configuration** (`.vscode/launch.json`):
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Python: Main",
      "type": "python",
      "request": "launch",
      "program": "${workspaceFolder}/main.py",
      "console": "integratedTerminal"
    },
    {
      "name": "Python: Backtest",
      "type": "python",
      "request": "launch",
      "program": "${workspaceFolder}/backtest/run_dca_backtest.py",
      "console": "integratedTerminal"
    }
  ]
}
```

#### PyCharm

1. **Open Project**: File â†’ Open â†’ Select `upbit_dca_trader`
2. **Configure Interpreter**:
   - Settings â†’ Project â†’ Python Interpreter
   - Add â†’ Existing Environment â†’ Select `venv/bin/python`
3. **Run Configuration**:
   - Script path: `main.py`
   - Working directory: Project root

### Debugging

**Enable Debug Logging**:

Edit `.env`:
```bash
LOG_LEVEL=DEBUG
```

Or in code:
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

**Test Individual Components**:

```bash
# Test Upbit API connection
python -c "from core.upbit_api import UpbitAPI; api = UpbitAPI(); print(api.get_ticker('KRW-BTC'))"

# Test strategy
python -c "from core.strategies import FilteredBBStrategy; s = FilteredBBStrategy('KRW-BTC'); print('Strategy OK')"

# Test WebSocket
python tests/test_websocket.py
```

### Git Configuration

```bash
# Set up git (if not already)
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"

# Check status
git status

# Create branch for development
git checkout -b feature/my-feature
```

---

## Production Deployment

### Cloud Deployment (Recommended)

**Why Cloud?**
- 24/7 uptime
- No local computer needed
- Reliable internet
- Professional infrastructure

#### AWS EC2

1. **Launch Instance**:
   - Ubuntu 22.04 LTS
   - t3.small (2GB RAM)
   - 20GB SSD

2. **Setup**:
```bash
# Update system
sudo apt update && sudo apt upgrade -y

# Install Python
sudo apt install python3.10 python3.10-venv python3-pip git -y

# Clone project
git clone https://github.com/jang1230/upbit-auto-trader.git
cd upbit-auto-trader/upbit_dca_trader

# Setup environment
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# Configure via .env file (headless server)
nano .env
```

3. **Run in background**:
```bash
# Using screen
screen -S trading
python main.py
# Press Ctrl+A then D to detach

# Resume: screen -r trading
```

#### Uptime Monitoring

```bash
# Using systemd service
sudo nano /etc/systemd/system/upbit-trader.service
```

```ini
[Unit]
Description=Upbit DCA Trader
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/upbit-auto-trader/upbit_dca_trader
Environment="PATH=/home/ubuntu/upbit-auto-trader/upbit_dca_trader/venv/bin"
ExecStart=/home/ubuntu/upbit-auto-trader/upbit_dca_trader/venv/bin/python main.py
Restart=always

[Install]
WantedBy=multi-user.target
```

```bash
# Enable and start
sudo systemctl enable upbit-trader
sudo systemctl start upbit-trader

# Check status
sudo systemctl status upbit-trader
```

### Local 24/7 Running

**Requirements**:
- Dedicated computer
- UPS (Uninterruptible Power Supply) recommended
- Stable internet
- Cooling/ventilation

**Setup**:

```bash
# Keep computer awake (macOS)
caffeinate -d python main.py

# Keep computer awake (Windows)
powercfg /change monitor-timeout-ac 0
powercfg /change standby-timeout-ac 0
```

**Auto-start on boot** (Windows):
1. Create batch file `start_trader.bat`:
```batch
cd C:\path\to\upbit_dca_trader
venv\Scripts\activate
python main.py
```
2. Add to Startup folder:
   - Win+R â†’ `shell:startup`
   - Copy `start_trader.bat` here

---

## Verification Checklist

Before running in production:

```
âœ… Python 3.8+ installed
âœ… All dependencies installed
âœ… Virtual environment activated
âœ… API keys configured (for live trading)
âœ… Telegram bot configured
âœ… Strategy selected
âœ… DCA settings configured
âœ… Risk settings configured
âœ… Dry run mode tested (minimum 1 week)
âœ… Telegram notifications working
âœ… Logs directory exists
âœ… Stable internet connection
âœ… Backup of configuration files
```

---

## Next Steps

1. **Test in Dry Run**: [README.md](README.md#2ë‹¨ê³„-í˜ì´í¼-íŠ¸ë ˆì´ë”©-ìµœì†Œ-1ì£¼ì¼-ê¶Œì¥)
2. **Monitor Performance**: Check Telegram notifications
3. **Review Logs**: `logs/trading.log`
4. **Gradual Deployment**: Start with minimum capital

---

## Support

- **Installation Issues**: [INSTALLATION.md](INSTALLATION.md)
- **Runtime Errors**: [TROUBLESHOOTING.md](TROUBLESHOOTING.md)
- **Telegram Setup**: [docs/TELEGRAM_ì„¤ì •_ê°€ì´ë“œ.md](docs/TELEGRAM_ì„¤ì •_ê°€ì´ë“œ.md)
- **GitHub Issues**: https://github.com/jang1230/upbit-auto-trader/issues

---

**Environment ready! Time to trade! ğŸš€**
